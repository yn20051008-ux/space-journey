<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Journey - å›ã ã‘ã®å®‡å®™èˆªæµ·å›³</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1f3a 50%, #0f1729 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* æ˜Ÿç©ºã®èƒŒæ™¯ */
        #stars {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 24px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 14px;
            color: #a0a0a0;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ */
        .setup-screen {
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .setup-screen.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 30px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .step.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            transform: scale(1.2);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }

        .step.completed {
            background: #4caf50;
        }

        .step-label {
            position: absolute;
            bottom: -25px;
            font-size: 10px;
            white-space: nowrap;
            color: #a0a0a0;
        }

        /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */
        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            color: #b0b0ff;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        /* æƒ‘æ˜Ÿé¸æŠ */
        .planets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .planet-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .planet-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.1);
        }

        .planet-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }

        .planet-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .planet-name {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .planet-desc {
            font-size: 11px;
            color: #a0a0a0;
        }

        /* ãƒœã‚¿ãƒ³ */
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* å®‡å®™ãƒãƒƒãƒ— */
        .space-map {
            display: none;
            position: relative;
            height: 600px;
            background: radial-gradient(ellipse at center, #1a1f3a 0%, #0a0e27 100%);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }

        .space-map.active {
            display: block;
        }

        .timeline-path {
            position: absolute;
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(102, 126, 234, 0.8) 50%, 
                rgba(255, 255, 255, 0.2) 100%);
            top: 50%;
            left: 10%;
            transform: translateY(-50%);
        }

        .space-object {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
        }

        .space-object:hover {
            transform: scale(1.2);
        }

        .past-zone {
            left: 10%;
            top: 50%;
            transform: translateY(-50%);
        }

        .present-zone {
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .future-zone {
            right: 10%;
            top: 50%;
            transform: translateY(-50%);
        }

        .spaceship {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
        }

        /* ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ */
        .dashboard {
            display: none;
            gap: 20px;
        }

        .dashboard.active {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šçŸ¥ */
        .weekly-review-notice {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            padding: 15px 20px;
            border-radius: 15px;
            animation: slideIn 0.5s;
            cursor: pointer;
            z-index: 1000;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .planets-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .space-map {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div id="stars"></div>

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header>
        <h1>ğŸš€ Space Journey</h1>
        <p class="subtitle">å›ã ã‘ã®å®‡å®™èˆªæµ·å›³</p>
    </header>

    <div class="container">
        <!-- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ Step 1: éå»ã®è¨˜éŒ² -->
        <div id="step1" class="setup-screen active">
            <div class="step-indicator">
                <div class="step active">
                    1
                    <span class="step-label">éå»ã®æ˜Ÿ</span>
                </div>
                <div class="step">
                    2
                    <span class="step-label">æœªæ¥ã®éŠ€æ²³</span>
                </div>
                <div class="step">
                    3
                    <span class="step-label">ç¾åœ¨åœ°</span>
                </div>
            </div>

            <h2>ğŸŒŸ éå»ã®æ˜Ÿã€…ã‚’è¨˜éŒ²ã—ã‚ˆã†</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">ã“ã‚Œã¾ã§ã®å¤§åˆ‡ãªæ€ã„å‡ºã‚„æˆé•·ã‚’æŒ¯ã‚Šè¿”ã‚Šã¾ã™</p>

            <div class="form-group">
                <label>ãŠåå‰ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼‰</label>
                <input type="text" id="userName" placeholder="å®‡å®™èˆ¹é•·ã®åå‰">
            </div>

            <div class="form-group">
                <label>ç”Ÿå¹´æœˆæ—¥</label>
                <input type="date" id="birthDate">
            </div>

            <div class="form-group">
                <label>ã“ã‚Œã¾ã§ã®å¤§ããªå‡ºæ¥äº‹ï¼ˆ3ã¤ã¾ã§ï¼‰</label>
                <textarea id="pastEvents" rows="4" placeholder="ä¾‹ï¼šå°å­¦æ ¡å…¥å­¦ã€åˆã‚ã¦ã®ç¿’ã„äº‹ã€è³ã‚’ã‚‚ã‚‰ã£ãŸ"></textarea>
            </div>

            <div class="form-group">
                <label>ä»Šã¾ã§ã§ä¸€ç•ªãŒã‚“ã°ã£ãŸã“ã¨</label>
                <input type="text" id="achievement" placeholder="ä¾‹ï¼šé€†ä¸ŠãŒã‚ŠãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ">
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="nextStep(2)">æœªæ¥ã¸é€²ã‚€ â†’</button>
            </div>
        </div>

        <!-- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ Step 2: æœªæ¥ã®è¨­å®š -->
        <div id="step2" class="setup-screen">
            <div class="step-indicator">
                <div class="step completed">
                    1
                    <span class="step-label">éå»ã®æ˜Ÿ</span>
                </div>
                <div class="step active">
                    2
                    <span class="step-label">æœªæ¥ã®éŠ€æ²³</span>
                </div>
                <div class="step">
                    3
                    <span class="step-label">ç¾åœ¨åœ°</span>
                </div>
            </div>

            <h2>ğŸŒŒ 10å¹´å¾Œã®éŠ€æ²³ã‚’è¨­è¨ˆã—ã‚ˆã†</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">ã©ã‚“ãªè‡ªåˆ†ã«ãªã‚ŠãŸã„ã‹ã€ç›®æ¨™ã‚’æ±ºã‚ã¾ã™</p>

            <div class="form-group">
                <label>10å¹´å¾Œã®è‡ªåˆ†ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</label>
                <textarea id="futureMessage" rows="3" placeholder="10å¹´å¾Œã®è‡ªåˆ†ã¯ã©ã‚“ãªäººã«ãªã£ã¦ã„ãŸã„ï¼Ÿ"></textarea>
            </div>

            <div class="form-group">
                <label>è‚²ã¦ãŸã„æƒ‘æ˜Ÿã‚’é¸ã¼ã†ï¼ˆ3ã¤ã¾ã§ï¼‰</label>
                <div class="planets-grid">
                    <div class="planet-card" data-planet="study">
                        <div class="planet-icon">ğŸ“š</div>
                        <div class="planet-name">å­¦ç¿’æƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">å‹‰å¼·ãƒ»è³‡æ ¼</div>
                    </div>
                    <div class="planet-card" data-planet="health">
                        <div class="planet-icon">ğŸ’ª</div>
                        <div class="planet-name">å¥åº·æƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">é‹å‹•ãƒ»ä½“åŠ›</div>
                    </div>
                    <div class="planet-card" data-planet="friend">
                        <div class="planet-icon">ğŸ‘¥</div>
                        <div class="planet-name">å‹æƒ…æƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">å‹é”ãƒ»ä»²é–“</div>
                    </div>
                    <div class="planet-card" data-planet="create">
                        <div class="planet-icon">ğŸ¨</div>
                        <div class="planet-name">å‰µé€ æƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">è¶£å‘³ãƒ»ä½œå“</div>
                    </div>
                    <div class="planet-card" data-planet="money">
                        <div class="planet-icon">ğŸ’°</div>
                        <div class="planet-name">è²¡å‹™æƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">è²¯é‡‘ãƒ»ãŠé‡‘</div>
                    </div>
                    <div class="planet-card" data-planet="adventure">
                        <div class="planet-icon">ğŸ—ºï¸</div>
                        <div class="planet-name">å†’é™ºæƒ‘æ˜Ÿ</div>
                        <div class="planet-desc">ä½“é¨“ãƒ»æŒ‘æˆ¦</div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-secondary" onclick="nextStep(1)">â† æˆ»ã‚‹</button>
                <button class="btn-primary" onclick="nextStep(3)">ç¾åœ¨åœ°ã‚’ç¢ºèª â†’</button>
            </div>
        </div>

        <!-- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ Step 3: ç¾åœ¨åœ°ç¢ºèª -->
        <div id="step3" class="setup-screen">
            <div class="step-indicator">
                <div class="step completed">
                    1
                    <span class="step-label">éå»ã®æ˜Ÿ</span>
                </div>
                <div class="step completed">
                    2
                    <span class="step-label">æœªæ¥ã®éŠ€æ²³</span>
                </div>
                <div class="step active">
                    3
                    <span class="step-label">ç¾åœ¨åœ°</span>
                </div>
            </div>

            <h2>ğŸš€ å›ã®ç¾åœ¨åœ°ãŒæ±ºã¾ã£ãŸï¼</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">éå»ã¨æœªæ¥ã‚’ç¹‹ãè»Œé“ä¸Šã«ã€ä»Šã®å›ãŒã„ã¾ã™</p>

            <div class="space-map active" style="display: block;">
                <div class="timeline-path"></div>
                
                <div class="space-object past-zone">
                    <div style="text-align: center;">
                        <div style="font-size: 30px;">ğŸŒŸ</div>
                        <div style="font-size: 12px; margin-top: 5px;">éå»ã®æ˜Ÿã€…</div>
                    </div>
                </div>
                
                <div class="space-object present-zone">
                    <div class="spaceship"></div>
                    <div style="text-align: center; margin-top: 70px;">
                        <div style="font-size: 14px; font-weight: bold;">ç¾åœ¨åœ°</div>
                    </div>
                </div>
                
                <div class="space-object future-zone">
                    <div style="text-align: center;">
                        <div style="font-size: 40px;">ğŸŒŒ</div>
                        <div style="font-size: 12px; margin-top: 5px;">ç›®æ¨™ã®éŠ€æ²³</div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-secondary" onclick="nextStep(2)">â† æˆ»ã‚‹</button>
                <button class="btn-primary" onclick="startJourney()">ğŸš€ å®‡å®™ã®æ—…ã‚’å§‹ã‚ã‚‹ï¼</button>
            </div>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-card">
                <h3>ğŸ“ ç¾åœ¨åœ°æƒ…å ±</h3>
                <p style="margin: 15px 0; color: #a0a0a0;">éå»ã‹ã‚‰ã®è·é›¢: <span id="pastDistance">0</span>æ—¥</p>
                <p style="margin: 15px 0; color: #a0a0a0;">æœªæ¥ã¾ã§ã®è·é›¢: <span id="futureDistance">3650</span>æ—¥</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="journeyProgress" style="width: 0%">
                        0%
                    </div>
                </div>
            </div>

            <div class="dashboard-card">
                <h3>ğŸª æƒ‘æ˜Ÿã®æˆé•·</h3>
                <div id="planetProgress"></div>
            </div>

            <div class="dashboard-card">
                <h3>ğŸ“… ä»Šé€±ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³</h3>
                <p style="margin: 15px 0; color: #a0a0a0;">æ¬¡ã®è»Œé“ä¿®æ­£: <span id="nextReview">æ—¥æ›œæ—¥</span></p>
                <button class="btn-primary" style="width: 100%; margin-top: 10px;" onclick="openWeeklyReview()">
                    é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é–‹ã
                </button>
            </div>

            <div class="dashboard-card">
                <h3>ğŸ† å®Ÿç¸¾</h3>
                <p style="margin: 15px 0;">ğŸ–ï¸ å®‡å®™èˆ¹é•·å°±ä»»</p>
                <p style="margin: 15px 0; color: #a0a0a0;">é€£ç¶šè»Œé“ä¿®æ­£: <span id="streakCount">0</span>é€±</p>
            </div>
        </div>

        <!-- å®‡å®™ãƒãƒƒãƒ—ï¼ˆãƒ¡ã‚¤ãƒ³ç”»é¢ï¼‰ -->
        <div id="mainSpaceMap" class="space-map">
            <div class="timeline-path"></div>
            
            <div class="space-object past-zone">
                <div style="text-align: center;">
                    <div style="font-size: 30px;">ğŸŒŸ</div>
                    <div style="font-size: 12px; margin-top: 5px;">éå»ã®æ˜Ÿã€…</div>
                </div>
            </div>
            
            <div class="space-object present-zone">
                <div class="spaceship"></div>
                <div style="text-align: center; margin-top: 70px;">
                    <div style="font-size: 14px; font-weight: bold;">ç¾åœ¨åœ°</div>
                </div>
            </div>
            
            <div class="space-object future-zone">
                <div style="text-align: center;">
                    <div style="font-size: 40px;">ğŸŒŒ</div>
                    <div style="font-size: 12px; margin-top: 5px;">ç›®æ¨™ã®éŠ€æ²³</div>
                </div>
            </div>
        </div>
    </div>

    <!-- é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šçŸ¥ -->
    <div id="weeklyReviewNotice" class="weekly-review-notice" onclick="openWeeklyReview()">
        ğŸŒŸ æ—¥æ›œæ—¥ã®è»Œé“ä¿®æ­£ã®æ™‚é–“ã§ã™ï¼
    </div>

    <script>
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
        let appData = {
            userName: '',
            birthDate: '',
            pastEvents: '',
            achievement: '',
            futureMessage: '',
            selectedPlanets: [],
            journeyStartDate: null,
            weeklyStreak: 0,
            lastReviewDate: null
        };

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        function loadData() {
            const saved = localStorage.getItem('spaceJourneyData');
            if (saved) {
                appData = JSON.parse(saved);
                showDashboard();
            }
        }

        // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
        function saveData() {
            localStorage.setItem('spaceJourneyData', JSON.stringify(appData));
        }

        // æ˜Ÿç©ºã®ç”Ÿæˆ
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—ç§»å‹•
        function nextStep(step) {
            // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
            if (step === 2) {
                appData.userName = document.getElementById('userName').value;
                appData.birthDate = document.getElementById('birthDate').value;
                appData.pastEvents = document.getElementById('pastEvents').value;
                appData.achievement = document.getElementById('achievement').value;
            } else if (step === 3) {
                appData.futureMessage = document.getElementById('futureMessage').value;
            }

            // ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
            document.querySelectorAll('.setup-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // æŒ‡å®šã•ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
            document.getElementById('step' + step).classList.add('active');
        }

        // æƒ‘æ˜Ÿé¸æŠ
        document.querySelectorAll('.planet-card').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('selected')) {
                    this.classList.remove('selected');
                    appData.selectedPlanets = appData.selectedPlanets.filter(p => p !== this.dataset.planet);
                } else if (appData.selectedPlanets.length < 3) {
                    this.classList.add('selected');
                    appData.selectedPlanets.push(this.dataset.planet);
                } else {
                    alert('æƒ‘æ˜Ÿã¯3ã¤ã¾ã§é¸æŠã§ãã¾ã™');
                }
            });
        });

        // æ—…ã‚’é–‹å§‹
        function startJourney() {
            appData.journeyStartDate = new Date().toISOString();
            saveData();
            showDashboard();
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
        function showDashboard() {
            // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ã‚’éè¡¨ç¤º
            document.querySelectorAll('.setup-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¨ãƒãƒƒãƒ—ã‚’è¡¨ç¤º
            document.getElementById('dashboard').classList.add('active');
            document.getElementById('mainSpaceMap').classList.add('active');

            // ãƒ‡ãƒ¼ã‚¿æ›´æ–°
            updateDashboard();
            
            // æ—¥æ›œæ—¥ã‹ãƒã‚§ãƒƒã‚¯
            checkSundayReview();
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
        function updateDashboard() {
            if (!appData.birthDate || !appData.journeyStartDate) return;

            // éå»ã‹ã‚‰ã®æ—¥æ•°è¨ˆç®—
            const birth = new Date(appData.birthDate);
            const now = new Date();
            const pastDays = Math.floor((now - birth) / (1000 * 60 * 60 * 24));
            document.getElementById('pastDistance').textContent = pastDays;

            // é€²æ—è¨ˆç®—
            const totalDays = 365 * 10; // 10å¹´
            const journeyStart = new Date(appData.journeyStartDate);
            const journeyDays = Math.floor((now - journeyStart) / (1000 * 60 * 60 * 24));
            const progress = Math.min((journeyDays / totalDays) * 100, 100);
            
            const progressBar = document.getElementById('journeyProgress');
            progressBar.style.width = progress + '%';
            progressBar.textContent = Math.floor(progress) + '%';

            // æœªæ¥ã¾ã§ã®æ—¥æ•°
            document.getElementById('futureDistance').textContent = Math.max(totalDays - journeyDays, 0);

            // æƒ‘æ˜Ÿã®é€²æ—è¡¨ç¤º
            const planetNames = {
                study: 'ğŸ“š å­¦ç¿’æƒ‘æ˜Ÿ',
                health: 'ğŸ’ª å¥åº·æƒ‘æ˜Ÿ',
                friend: 'ğŸ‘¥ å‹æƒ…æƒ‘æ˜Ÿ',
                create: 'ğŸ¨ å‰µé€ æƒ‘æ˜Ÿ',
                money: 'ğŸ’° è²¡å‹™æƒ‘æ˜Ÿ',
                adventure: 'ğŸ—ºï¸ å†’é™ºæƒ‘æ˜Ÿ'
            };

            const planetProgressDiv = document.getElementById('planetProgress');
            planetProgressDiv.innerHTML = '';
            
            appData.selectedPlanets.forEach(planet => {
                const progressHtml = `
                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>${planetNames[planet]}</span>
                            <span style="color: #a0a0a0;">ãƒ¬ãƒ™ãƒ« 1</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.random() * 50 + 10}%"></div>
                        </div>
                    </div>
                `;
                planetProgressDiv.innerHTML += progressHtml;
            });

            // é€£ç¶šè»Œé“ä¿®æ­£
            document.getElementById('streakCount').textContent = appData.weeklyStreak;
        }

        // æ—¥æ›œæ—¥ãƒã‚§ãƒƒã‚¯
        function checkSundayReview() {
            const today = new Date();
            if (today.getDay() === 0) { // æ—¥æ›œæ—¥
                const lastReview = appData.lastReviewDate ? new Date(appData.lastReviewDate) : null;
                const daysSinceReview = lastReview ? 
                    Math.floor((today - lastReview) / (1000 * 60 * 60 * 24)) : 999;
                
                if (daysSinceReview >= 7) {
                    document.getElementById('weeklyReviewNotice').style.display = 'block';
                }
            }
        }

        // é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é–‹ã
        function openWeeklyReview() {
            // é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä½œæˆ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                animation: fadeIn 0.3s;
            `;
            
            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, #1a1f3a, #0a0e27); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; border: 2px solid rgba(102, 126, 234, 0.3); box-shadow: 0 0 50px rgba(102, 126, 234, 0.3);">
                    <h2 style="text-align: center; margin-bottom: 20px;">ğŸŒŸ é€±æ¬¡è»Œé“ä¿®æ­£</h2>
                    <p style="color: #a0a0a0; margin-bottom: 20px;">èˆ¹é•·ï¼ä»Šé€±ã®èˆªæµ·è¨˜éŒ²ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†</p>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                        <p style="margin-bottom: 10px;">ğŸ“Š ä»Šé€±ã®æˆæœ</p>
                        <ul style="color: #b0b0ff; font-size: 14px; padding-left: 20px;">
                            <li>å®‡å®™èˆªè¡Œ: 7æ—¥é–“</li>
                            <li>ç²å¾—ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆ: â­ 42</li>
                            <li>æƒ‘æ˜Ÿæˆé•·ç‡: +12%</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">ä»Šé€±ä¸€ç•ªæˆé•·ã—ãŸæƒ‘æ˜Ÿã¯ï¼Ÿ</label>
                        <select id="grownPlanet" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;">
                            ${appData.selectedPlanets.map(p => {
                                const names = {study: 'å­¦ç¿’', health: 'å¥åº·', friend: 'å‹æƒ…', create: 'å‰µé€ ', money: 'è²¡å‹™', adventure: 'å†’é™º'};
                                return `<option value="${p}">${names[p]}æƒ‘æ˜Ÿ</option>`;
                            }).join('')}
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">æ¥é€±ã®é‡ç‚¹æƒ‘æ˜Ÿã¯ï¼Ÿ</label>
                        <select id="focusPlanet" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;">
                            ${appData.selectedPlanets.map(p => {
                                const names = {study: 'å­¦ç¿’', health: 'å¥åº·', friend: 'å‹æƒ…', create: 'å‰µé€ ', money: 'è²¡å‹™', adventure: 'å†’é™º'};
                                return `<option value="${p}">${names[p]}æƒ‘æ˜Ÿ</option>`;
                            }).join('')}
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">ä»Šé€±ã®æ°—ã¥ããƒ»ãƒ¡ãƒ¢</label>
                        <textarea id="weeklyNote" rows="3" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;" placeholder="ä»Šé€±å­¦ã‚“ã ã“ã¨ã€æ¥é€±ã¸ã®æ„æ°—è¾¼ã¿ãªã©"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button onclick="completeWeeklyReview(this.parentElement.parentElement.parentElement)" style="flex: 1; padding: 12px; background: linear-gradient(45deg, #667eea, #764ba2); border: none; border-radius: 25px; color: white; font-weight: bold; cursor: pointer;">
                            âœ¨ è»Œé“ä¿®æ­£å®Œäº†
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="flex: 1; padding: 12px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 25px; color: white; font-weight: bold; cursor: pointer;">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            document.getElementById('weeklyReviewNotice').style.display = 'none';
        }
        
        // é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
        function completeWeeklyReview(modal) {
            appData.lastReviewDate = new Date().toISOString();
            appData.weeklyStreak++;
            saveData();
            
            // å®Œäº†ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            const celebration = document.createElement('div');
            celebration.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 60px;
                z-index: 3000;
                animation: celebrate 1s ease-out;
            `;
            celebration.innerHTML = 'ğŸ‰';
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                celebration.remove();
                modal.remove();
                updateDashboard();
                
                // ãƒœãƒ¼ãƒŠã‚¹é€šçŸ¥
                if (appData.weeklyStreak % 4 === 0) {
                    showNotification(`ğŸ† ${appData.weeklyStreak}é€±é€£ç¶šé”æˆï¼å®‡å®™èˆ¹ãŒã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸï¼`);
                } else {
                    showNotification('âœ¨ è»Œé“ä¿®æ­£å®Œäº†ï¼æ¥é€±ã‚‚é ‘å¼µã‚ã†ï¼');
                }
            }, 1000);
        }
        
        // é€šçŸ¥è¡¨ç¤º
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(45deg, #4caf50, #8bc34a);
                padding: 15px 30px;
                border-radius: 25px;
                color: white;
                font-weight: bold;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 3000;
                animation: slideDown 0.5s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.5s ease-out';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨CSSè¿½åŠ 
        const style = document.createElement('style');
        style.textContent = `
            @keyframes celebrate {
                0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.5) rotate(180deg); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
            }
            
            @keyframes slideDown {
                from { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                to { transform: translateX(-50%) translateY(0); opacity: 1; }
            }
            
            @keyframes slideUp {
                from { transform: translateX(-50%) translateY(0); opacity: 1; }
                to { transform: translateX(-50%) translateY(-100px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', function() {
            createStars();
            loadData();
        });
    </script>
</body>
</html>
