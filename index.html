<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Journey - Âêõ„Å†„Åë„ÅÆÂÆáÂÆôËà™Êµ∑Âõ≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1f3a 50%, #0f1729 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ÊòüÁ©∫„ÅÆËÉåÊôØ */
        #stars {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 24px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 14px;
            color: #a0a0a0;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢ */
        .setup-screen {
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .setup-screen.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 30px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .step.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            transform: scale(1.2);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }

        .step.completed {
            background: #4caf50;
        }

        .step-label {
            position: absolute;
            bottom: -25px;
            font-size: 10px;
            white-space: nowrap;
            color: #a0a0a0;
        }

        /* ÂÖ•Âäõ„Éï„Ç©„Éº„É† */
        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            color: #b0b0ff;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        /* ÊÉëÊòüÈÅ∏Êäû */
        .planets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .planet-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .planet-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.1);
        }

        .planet-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }

        .planet-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .planet-name {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .planet-desc {
            font-size: 11px;
            color: #a0a0a0;
        }

        /* „Éú„Çø„É≥ */
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* ÂÆáÂÆô„Éû„ÉÉ„Éó */
        .space-map {
            display: none;
            position: relative;
            height: 600px;
            background: radial-gradient(ellipse at center, #1a1f3a 0%, #0a0e27 100%);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }

        .space-map.active {
            display: block;
        }

        .timeline-path {
            position: absolute;
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(102, 126, 234, 0.8) 50%, 
                rgba(255, 255, 255, 0.2) 100%);
            top: 50%;
            left: 10%;
            transform: translateY(-50%);
        }

        .space-object {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
        }

        .space-object:hover {
            transform: scale(1.2);
        }

        .past-zone {
            left: 10%;
            top: 50%;
            transform: translateY(-50%);
        }

        .present-zone {
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .future-zone {
            right: 10%;
            top: 50%;
            transform: translateY(-50%);
        }

        .spaceship {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
        }

        /* „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ */
        .dashboard {
            display: none;
            gap: 20px;
        }

        .dashboard.active {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* ÈÄ±Ê¨°„É¨„Éì„É•„ÉºÈÄöÁü• */
        .weekly-review-notice {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            padding: 15px 20px;
            border-radius: 15px;
            animation: slideIn 0.5s;
            cursor: pointer;
            z-index: 1000;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ */
        @media (max-width: 768px) {
            .planets-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .space-map {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- ÊòüÁ©∫ËÉåÊôØ -->
    <div id="stars"></div>

    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <header>
        <h1>üöÄ Space Journey</h1>
        <p class="subtitle">Âêõ„Å†„Åë„ÅÆÂÆáÂÆôËà™Êµ∑Âõ≥</p>
    </header>

    <div class="container">
        <!-- „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢ Step 1: ÈÅéÂéª„ÅÆË®òÈå≤ -->
        <div id="step1" class="setup-screen active">
            <div class="step-indicator">
                <div class="step active">
                    1
                    <span class="step-label">ÈÅéÂéª„ÅÆÊòü</span>
                </div>
                <div class="step">
                    2
                    <span class="step-label">Êú™Êù•„ÅÆÈäÄÊ≤≥</span>
                </div>
                <div class="step">
                    3
                    <span class="step-label">ÁèæÂú®Âú∞</span>
                </div>
            </div>

            <h2>üåü ÈÅéÂéª„ÅÆÊòü„ÄÖ„ÇíË®òÈå≤„Åó„Çà„ÅÜ</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">„Åì„Çå„Åæ„Åß„ÅÆÂ§ßÂàá„Å™ÊÄù„ÅÑÂá∫„ÇÑÊàêÈï∑„ÇíÊåØ„ÇäËøî„Çä„Åæ„Åô</p>

            <div class="form-group">
                <label>„ÅäÂêçÂâçÔºà„Éã„ÉÉ„ÇØ„Éç„Éº„É†Ôºâ</label>
                <input type="text" id="userName" placeholder="ÂÆáÂÆôËàπÈï∑„ÅÆÂêçÂâç">
            </div>

            <div class="form-group">
                <label>ÁîüÂπ¥ÊúàÊó•</label>
                <input type="date" id="birthDate">
            </div>

            <div class="form-group">
                <label>„Åì„Çå„Åæ„Åß„ÅÆÂ§ß„Åç„Å™Âá∫Êù•‰∫ãÔºà3„Å§„Åæ„ÅßÔºâ</label>
                <textarea id="pastEvents" rows="4" placeholder="‰æãÔºöÂ∞èÂ≠¶Ê†°ÂÖ•Â≠¶„ÄÅÂàù„ÇÅ„Å¶„ÅÆÁøí„ÅÑ‰∫ã„ÄÅË≥û„Çí„ÇÇ„Çâ„Å£„Åü"></textarea>
            </div>

            <div class="form-group">
                <label>‰ªä„Åæ„Åß„Åß‰∏ÄÁï™„Åå„Çì„Å∞„Å£„Åü„Åì„Å®</label>
                <input type="text" id="achievement" placeholder="‰æãÔºöÈÄÜ‰∏ä„Åå„Çä„Åå„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Å£„Åü">
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="nextStep(2)">Êú™Êù•„Å∏ÈÄ≤„ÇÄ ‚Üí</button>
            </div>
        </div>

        <!-- „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢ Step 2: Êú™Êù•„ÅÆË®≠ÂÆö -->
        <div id="step2" class="setup-screen">
            <div class="step-indicator">
                <div class="step completed">
                    1
                    <span class="step-label">ÈÅéÂéª„ÅÆÊòü</span>
                </div>
                <div class="step active">
                    2
                    <span class="step-label">Êú™Êù•„ÅÆÈäÄÊ≤≥</span>
                </div>
                <div class="step">
                    3
                    <span class="step-label">ÁèæÂú®Âú∞</span>
                </div>
            </div>

            <h2>üåå 10Âπ¥Âæå„ÅÆÈäÄÊ≤≥„ÇíË®≠Ë®à„Åó„Çà„ÅÜ</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">„Å©„Çì„Å™Ëá™ÂàÜ„Å´„Å™„Çä„Åü„ÅÑ„Åã„ÄÅÁõÆÊ®ô„ÇíÊ±∫„ÇÅ„Åæ„Åô</p>

            <div class="form-group">
                <label>10Âπ¥Âæå„ÅÆËá™ÂàÜ„Å∏„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏</label>
                <textarea id="futureMessage" rows="3" placeholder="10Âπ¥Âæå„ÅÆËá™ÂàÜ„ÅØ„Å©„Çì„Å™‰∫∫„Å´„Å™„Å£„Å¶„ÅÑ„Åü„ÅÑÔºü"></textarea>
            </div>

            <div class="form-group">
                <label>ËÇ≤„Å¶„Åü„ÅÑÊÉëÊòü„ÇíÈÅ∏„Åº„ÅÜÔºà3„Å§„Åæ„ÅßÔºâ</label>
                <div class="planets-grid">
                    <div class="planet-card" data-planet="study">
                        <div class="planet-icon">üìö</div>
                        <div class="planet-name">Â≠¶ÁøíÊÉëÊòü</div>
                        <div class="planet-desc">ÂãâÂº∑„ÉªË≥áÊ†º</div>
                    </div>
                    <div class="planet-card" data-planet="health">
                        <div class="planet-icon">üí™</div>
                        <div class="planet-name">ÂÅ•Â∫∑ÊÉëÊòü</div>
                        <div class="planet-desc">ÈÅãÂãï„Éª‰ΩìÂäõ</div>
                    </div>
                    <div class="planet-card" data-planet="friend">
                        <div class="planet-icon">üë•</div>
                        <div class="planet-name">ÂèãÊÉÖÊÉëÊòü</div>
                        <div class="planet-desc">ÂèãÈÅî„Éª‰ª≤Èñì</div>
                    </div>
                    <div class="planet-card" data-planet="create">
                        <div class="planet-icon">üé®</div>
                        <div class="planet-name">ÂâµÈÄ†ÊÉëÊòü</div>
                        <div class="planet-desc">Ë∂£Âë≥„Éª‰ΩúÂìÅ</div>
                    </div>
                    <div class="planet-card" data-planet="money">
                        <div class="planet-icon">üí∞</div>
                        <div class="planet-name">Ë≤°ÂãôÊÉëÊòü</div>
                        <div class="planet-desc">Ë≤ØÈáë„Éª„ÅäÈáë</div>
                    </div>
                    <div class="planet-card" data-planet="adventure">
                        <div class="planet-icon">üó∫Ô∏è</div>
                        <div class="planet-name">ÂÜíÈô∫ÊÉëÊòü</div>
                        <div class="planet-desc">‰ΩìÈ®ì„ÉªÊåëÊà¶</div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-secondary" onclick="nextStep(1)">‚Üê Êàª„Çã</button>
                <button class="btn-primary" onclick="nextStep(3)">ÁèæÂú®Âú∞„ÇíÁ¢∫Ë™ç ‚Üí</button>
            </div>
        </div>

        <!-- „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢ Step 3: ÁèæÂú®Âú∞Á¢∫Ë™ç -->
        <div id="step3" class="setup-screen">
            <div class="step-indicator">
                <div class="step completed">
                    1
                    <span class="step-label">ÈÅéÂéª„ÅÆÊòü</span>
                </div>
                <div class="step completed">
                    2
                    <span class="step-label">Êú™Êù•„ÅÆÈäÄÊ≤≥</span>
                </div>
                <div class="step active">
                    3
                    <span class="step-label">ÁèæÂú®Âú∞</span>
                </div>
            </div>

            <h2>üöÄ Âêõ„ÅÆÁèæÂú®Âú∞„ÅåÊ±∫„Åæ„Å£„ÅüÔºÅ</h2>
            <p style="margin-bottom: 20px; color: #a0a0a0;">ÈÅéÂéª„Å®Êú™Êù•„ÇíÁπã„ÅêËªåÈÅì‰∏ä„Å´„ÄÅ‰ªä„ÅÆÂêõ„Åå„ÅÑ„Åæ„Åô</p>

            <div class="space-map active" style="display: block;">
                <div class="timeline-path"></div>
                
                <div class="space-object past-zone">
                    <div style="text-align: center;">
                        <div style="font-size: 30px;">üåü</div>
                        <div style="font-size: 12px; margin-top: 5px;">ÈÅéÂéª„ÅÆÊòü„ÄÖ</div>
                    </div>
                </div>
                
                <div class="space-object present-zone">
                    <div class="spaceship"></div>
                    <div style="text-align: center; margin-top: 70px;">
                        <div style="font-size: 14px; font-weight: bold;">ÁèæÂú®Âú∞</div>
                    </div>
                </div>
                
                <div class="space-object future-zone">
                    <div style="text-align: center;">
                        <div style="font-size: 40px;">üåå</div>
                        <div style="font-size: 12px; margin-top: 5px;">ÁõÆÊ®ô„ÅÆÈäÄÊ≤≥</div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-secondary" onclick="nextStep(2)">‚Üê Êàª„Çã</button>
                <button class="btn-primary" onclick="startJourney()">üöÄ ÂÆáÂÆô„ÅÆÊóÖ„ÇíÂßã„ÇÅ„ÇãÔºÅ</button>
            </div>
        </div>

        <!-- „É°„Ç§„É≥„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-card">
                <h3>üìç ÁèæÂú®Âú∞ÊÉÖÂ†±</h3>
                <p style="margin: 15px 0; color: #a0a0a0;">ÈÅéÂéª„Åã„Çâ„ÅÆË∑ùÈõ¢: <span id="pastDistance">0</span>Êó•</p>
                <p style="margin: 15px 0; color: #a0a0a0;">Êú™Êù•„Åæ„Åß„ÅÆË∑ùÈõ¢: <span id="futureDistance">3650</span>Êó•</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="journeyProgress" style="width: 0%">
                        0%
                    </div>
                </div>
            </div>

            <div class="dashboard-card">
                <h3>ü™ê ÊÉëÊòü„ÅÆÊàêÈï∑</h3>
                <div id="planetProgress"></div>
            </div>

            <div class="dashboard-card">
                <h3>üìÖ ‰ªäÈÄ±„ÅÆ„Éü„ÉÉ„Ç∑„Éß„É≥</h3>
                <p style="margin: 15px 0; color: #a0a0a0;">Ê¨°„ÅÆËªåÈÅì‰øÆÊ≠£: <span id="nextReview">Êó•ÊõúÊó•</span></p>
                <button class="btn-primary" style="width: 100%; margin-top: 10px;" onclick="openWeeklyReview()">
                    ÈÄ±Ê¨°„É¨„Éì„É•„Éº„ÇíÈñã„Åè
                </button>
            </div>

            <div class="dashboard-card">
                <h3>üèÜ ÂÆüÁ∏æ</h3>
                <p style="margin: 15px 0;">üéñÔ∏è ÂÆáÂÆôËàπÈï∑Â∞±‰ªª</p>
                <p style="margin: 15px 0; color: #a0a0a0;">ÈÄ£Á∂öËªåÈÅì‰øÆÊ≠£: <span id="streakCount">0</span>ÈÄ±</p>
            </div>
        </div>

        <!-- ÂÆáÂÆô„Éû„ÉÉ„ÉóÔºà„É°„Ç§„É≥ÁîªÈù¢Ôºâ -->
        <div id="mainSpaceMap" class="space-map">
            <div class="timeline-path"></div>
            
            <div class="space-object past-zone">
                <div style="text-align: center;">
                    <div style="font-size: 30px;">üåü</div>
                    <div style="font-size: 12px; margin-top: 5px;">ÈÅéÂéª„ÅÆÊòü„ÄÖ</div>
                </div>
            </div>
            
            <div class="space-object present-zone">
                <div class="spaceship"></div>
                <div style="text-align: center; margin-top: 70px;">
                    <div style="font-size: 14px; font-weight: bold;">ÁèæÂú®Âú∞</div>
                </div>
            </div>
            
            <div class="space-object future-zone">
                <div style="text-align: center;">
                    <div style="font-size: 40px;">üåå</div>
                    <div style="font-size: 12px; margin-top: 5px;">ÁõÆÊ®ô„ÅÆÈäÄÊ≤≥</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÈÄ±Ê¨°„É¨„Éì„É•„ÉºÈÄöÁü• -->
    <div id="weeklyReviewNotice" class="weekly-review-notice" onclick="openWeeklyReview()">
        üåü Êó•ÊõúÊó•„ÅÆËªåÈÅì‰øÆÊ≠£„ÅÆÊôÇÈñì„Åß„ÅôÔºÅ
    </div>

    <script>
        // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Éá„Éº„Çø
        let appData = {
            userName: '',
            birthDate: '',
            pastEvents: '',
            achievement: '',
            futureMessage: '',
            selectedPlanets: [],
            journeyStartDate: null,
            weeklyStreak: 0,
            lastReviewDate: null
        };

        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
        function loadData() {
            const saved = localStorage.getItem('spaceJourneyData');
            if (saved) {
                appData = JSON.parse(saved);
                showDashboard();
            }
        }

        // „Éá„Éº„Çø„Çí‰øùÂ≠ò
        function saveData() {
            localStorage.setItem('spaceJourneyData', JSON.stringify(appData));
        }

        // ÊòüÁ©∫„ÅÆÁîüÊàê
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // „Çπ„ÉÜ„ÉÉ„ÉóÁßªÂãï
        function nextStep(step) {
            // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„ÅÆ„Éá„Éº„Çø„Çí‰øùÂ≠ò
            if (step === 2) {
                appData.userName = document.getElementById('userName').value;
                appData.birthDate = document.getElementById('birthDate').value;
                appData.pastEvents = document.getElementById('pastEvents').value;
                appData.achievement = document.getElementById('achievement').value;
            } else if (step === 3) {
                appData.futureMessage = document.getElementById('futureMessage').value;
            }

            // „Åô„Åπ„Å¶„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.setup-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // ÊåáÂÆö„Åï„Çå„Åü„Çπ„ÉÜ„ÉÉ„Éó„ÇíË°®Á§∫
            document.getElementById('step' + step).classList.add('active');
        }

        // ÊÉëÊòüÈÅ∏Êäû
        document.querySelectorAll('.planet-card').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('selected')) {
                    this.classList.remove('selected');
                    appData.selectedPlanets = appData.selectedPlanets.filter(p => p !== this.dataset.planet);
                } else if (appData.selectedPlanets.length < 3) {
                    this.classList.add('selected');
                    appData.selectedPlanets.push(this.dataset.planet);
                } else {
                    alert('ÊÉëÊòü„ÅØ3„Å§„Åæ„ÅßÈÅ∏Êäû„Åß„Åç„Åæ„Åô');
                }
            });
        });

        // ÊóÖ„ÇíÈñãÂßã
        function startJourney() {
            appData.journeyStartDate = new Date().toISOString();
            saveData();
            showDashboard();
        }

        // „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâË°®Á§∫
        function showDashboard() {
            // „Çª„ÉÉ„Éà„Ç¢„ÉÉ„ÉóÁîªÈù¢„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.setup-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Å®„Éû„ÉÉ„Éó„ÇíË°®Á§∫
            document.getElementById('dashboard').classList.add('active');
            document.getElementById('mainSpaceMap').classList.add('active');

            // „Éá„Éº„ÇøÊõ¥Êñ∞
            updateDashboard();
            
            // Êó•ÊõúÊó•„Åã„ÉÅ„Çß„ÉÉ„ÇØ
            checkSundayReview();
        }

        // „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÊõ¥Êñ∞
        function updateDashboard() {
            if (!appData.birthDate || !appData.journeyStartDate) return;

            // ÈÅéÂéª„Åã„Çâ„ÅÆÊó•Êï∞Ë®àÁÆó
            const birth = new Date(appData.birthDate);
            const now = new Date();
            const pastDays = Math.floor((now - birth) / (1000 * 60 * 60 * 24));
            document.getElementById('pastDistance').textContent = pastDays;

            // ÈÄ≤ÊçóË®àÁÆó
            const totalDays = 365 * 10; // 10Âπ¥
            const journeyStart = new Date(appData.journeyStartDate);
            const journeyDays = Math.floor((now - journeyStart) / (1000 * 60 * 60 * 24));
            const progress = Math.min((journeyDays / totalDays) * 100, 100);
            
            const progressBar = document.getElementById('journeyProgress');
            progressBar.style.width = progress + '%';
            progressBar.textContent = Math.floor(progress) + '%';

            // Êú™Êù•„Åæ„Åß„ÅÆÊó•Êï∞
            document.getElementById('futureDistance').textContent = Math.max(totalDays - journeyDays, 0);

            // ÊÉëÊòü„ÅÆÈÄ≤ÊçóË°®Á§∫
            const planetNames = {
                study: 'üìö Â≠¶ÁøíÊÉëÊòü',
                health: 'üí™ ÂÅ•Â∫∑ÊÉëÊòü',
                friend: 'üë• ÂèãÊÉÖÊÉëÊòü',
                create: 'üé® ÂâµÈÄ†ÊÉëÊòü',
                money: 'üí∞ Ë≤°ÂãôÊÉëÊòü',
                adventure: 'üó∫Ô∏è ÂÜíÈô∫ÊÉëÊòü'
            };

            const planetProgressDiv = document.getElementById('planetProgress');
            planetProgressDiv.innerHTML = '';
            
            appData.selectedPlanets.forEach(planet => {
                const progressHtml = `
                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>${planetNames[planet]}</span>
                            <span style="color: #a0a0a0;">„É¨„Éô„É´ 1</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.random() * 50 + 10}%"></div>
                        </div>
                    </div>
                `;
                planetProgressDiv.innerHTML += progressHtml;
            });

            // ÈÄ£Á∂öËªåÈÅì‰øÆÊ≠£
            document.getElementById('streakCount').textContent = appData.weeklyStreak;
        }

        // Êó•ÊõúÊó•„ÉÅ„Çß„ÉÉ„ÇØ
        function checkSundayReview() {
            const today = new Date();
            if (today.getDay() === 0) { // Êó•ÊõúÊó•
                const lastReview = appData.lastReviewDate ? new Date(appData.lastReviewDate) : null;
                const daysSinceReview = lastReview ? 
                    Math.floor((today - lastReview) / (1000 * 60 * 60 * 24)) : 999;
                
                if (daysSinceReview >= 7) {
                    document.getElementById('weeklyReviewNotice').style.display = 'block';
                }
            }
        }

        // ÈÄ±Ê¨°„É¨„Éì„É•„Éº„ÇíÈñã„Åè
        function openWeeklyReview() {
            // ÈÄ±Ê¨°„É¨„Éì„É•„Éº„É¢„Éº„ÉÄ„É´„Çí‰ΩúÊàê
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                animation: fadeIn 0.3s;
            `;
            
            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, #1a1f3a, #0a0e27); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; border: 2px solid rgba(102, 126, 234, 0.3); box-shadow: 0 0 50px rgba(102, 126, 234, 0.3);">
                    <h2 style="text-align: center; margin-bottom: 20px;">üåü ÈÄ±Ê¨°ËªåÈÅì‰øÆÊ≠£</h2>
                    <p style="color: #a0a0a0; margin-bottom: 20px;">ËàπÈï∑ÔºÅ‰ªäÈÄ±„ÅÆËà™Êµ∑Ë®òÈå≤„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åó„Çá„ÅÜ</p>
                    
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                        <p style="margin-bottom: 10px;">üìä ‰ªäÈÄ±„ÅÆÊàêÊûú</p>
                        <ul style="color: #b0b0ff; font-size: 14px; padding-left: 20px;">
                            <li>ÂÆáÂÆôËà™Ë°å: 7Êó•Èñì</li>
                            <li>Áç≤Âæó„Çπ„Çø„Éº„ÉÄ„Çπ„Éà: ‚≠ê 42</li>
                            <li>ÊÉëÊòüÊàêÈï∑Áéá: +12%</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">‰ªäÈÄ±‰∏ÄÁï™ÊàêÈï∑„Åó„ÅüÊÉëÊòü„ÅØÔºü</label>
                        <select id="grownPlanet" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;">
                            ${appData.selectedPlanets.map(p => {
                                const names = {study: 'Â≠¶Áøí', health: 'ÂÅ•Â∫∑', friend: 'ÂèãÊÉÖ', create: 'ÂâµÈÄ†', money: 'Ë≤°Âãô', adventure: 'ÂÜíÈô∫'};
                                return `<option value="${p}">${names[p]}ÊÉëÊòü</option>`;
                            }).join('')}
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">Êù•ÈÄ±„ÅÆÈáçÁÇπÊÉëÊòü„ÅØÔºü</label>
                        <select id="focusPlanet" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;">
                            ${appData.selectedPlanets.map(p => {
                                const names = {study: 'Â≠¶Áøí', health: 'ÂÅ•Â∫∑', friend: 'ÂèãÊÉÖ', create: 'ÂâµÈÄ†', money: 'Ë≤°Âãô', adventure: 'ÂÜíÈô∫'};
                                return `<option value="${p}">${names[p]}ÊÉëÊòü</option>`;
                            }).join('')}
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: #b0b0ff;">‰ªäÈÄ±„ÅÆÊ∞ó„Å•„Åç„Éª„É°„É¢</label>
                        <textarea id="weeklyNote" rows="3" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: white;" placeholder="‰ªäÈÄ±Â≠¶„Çì„Å†„Åì„Å®„ÄÅÊù•ÈÄ±„Å∏„ÅÆÊÑèÊ∞óËæº„Åø„Å™„Å©"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button onclick="completeWeeklyReview(this.parentElement.parentElement.parentElement)" style="flex: 1; padding: 12px; background: linear-gradient(45deg, #667eea, #764ba2); border: none; border-radius: 25px; color: white; font-weight: bold; cursor: pointer;">
                            ‚ú® ËªåÈÅì‰øÆÊ≠£ÂÆå‰∫Ü
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="flex: 1; padding: 12px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 25px; color: white; font-weight: bold; cursor: pointer;">
                            „Ç≠„É£„É≥„Çª„É´
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            document.getElementById('weeklyReviewNotice').style.display = 'none';
        }
        
        // ÈÄ±Ê¨°„É¨„Éì„É•„ÉºÂÆå‰∫Ü
        function completeWeeklyReview(modal) {
            appData.lastReviewDate = new Date().toISOString();
            appData.weeklyStreak++;
            saveData();
            
            // ÂÆå‰∫Ü„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            const celebration = document.createElement('div');
            celebration.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 60px;
                z-index: 3000;
                animation: celebrate 1s ease-out;
            `;
            celebration.innerHTML = 'üéâ';
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                celebration.remove();
                modal.remove();
                updateDashboard();
                
                // „Éú„Éº„Éä„ÇπÈÄöÁü•
                if (appData.weeklyStreak % 4 === 0) {
                    showNotification(`üèÜ ${appData.weeklyStreak}ÈÄ±ÈÄ£Á∂öÈÅîÊàêÔºÅÂÆáÂÆôËàπ„Åå„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„Åï„Çå„Åæ„Åó„ÅüÔºÅ`);
                } else {
                    showNotification('‚ú® ËªåÈÅì‰øÆÊ≠£ÂÆå‰∫ÜÔºÅÊù•ÈÄ±„ÇÇÈ†ëÂºµ„Çç„ÅÜÔºÅ');
                }
            }, 1000);
        }
        
        // ÈÄöÁü•Ë°®Á§∫
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(45deg, #4caf50, #8bc34a);
                padding: 15px 30px;
                border-radius: 25px;
                color: white;
                font-weight: bold;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 3000;
                animation: slideDown 0.5s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.5s ease-out';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }
        
        // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Áî®CSSËøΩÂä†
        const style = document.createElement('style');
        style.textContent = `
            @keyframes celebrate {
                0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.5) rotate(180deg); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
            }
            
            @keyframes slideDown {
                from { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                to { transform: translateX(-50%) translateY(0); opacity: 1; }
            }
            
            @keyframes slideUp {
                from { transform: translateX(-50%) translateY(0); opacity: 1; }
                to { transform: translateX(-50%) translateY(-100px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ÂàùÊúüÂåñ
        window.addEventListener('DOMContentLoaded', function() {
            createStars();
            loadData();
        });
    </script>
</body>
</html>
